<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Bootstrap p-Values • boot.pval</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Bootstrap p-Values">
<meta name="description" content="Computation of bootstrap p-values through inversion of confidence intervals, including convenience functions for regression models.">
<meta property="og:description" content="Computation of bootstrap p-values through inversion of confidence intervals, including convenience functions for regression models.">
<meta property="og:image" content="https://mthulin.github.io/boot.pval/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">boot.pval</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/boot_summary.html">An introduction to bootstrap p-values for regression models using the boot.pval package</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mthulin/boot.pval/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="bootpval-">boot.pval <a class="anchor" aria-label="anchor" href="#bootpval-"></a>
</h1>
</div>
<p>This R package provides functions for computing bootstrap p-values based on <code>boot</code> objects, and convenience functions for bootstrap confidence intervals and p-values for various regression models.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>To install the package from CRAN:</p>
<pre><code><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"boot.pval"</span><span class="op">)</span></span></code></pre>
<p>To install the development version from Github:</p>
<pre><code><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="fu">install_github</span><span class="op">(</span><span class="st">"mthulin/boot.pval"</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>p-values can be computed by inverting the corresponding confidence intervals, as described in Section 14.2 of <a href="https://www.modernstatisticswithr.com/mathschap.html#confintequal" class="external-link">Thulin (2024)</a> and Section 3.12 in <a href="https://link.springer.com/book/10.1007/978-1-4612-4384-7" class="external-link">Hall (1992)</a>. This package contains functions for computing bootstrap p-values in this way. The approach relies on the fact that:</p>
<ul>
<li>The p-value of the two-sided test for the parameter theta is the smallest alpha such that theta is not contained in the corresponding 1-alpha confidence interval,</li>
<li>For a test of the parameter theta with significance level alpha, the set of values of theta that aren’t rejected by the two-sided test (when used as the null hypothesis) is a 1-alpha confidence interval for theta.</li>
</ul>
</div>
<div class="section level2">
<h2 id="summaries-for-regression-models">Summaries for regression models<a class="anchor" aria-label="anchor" href="#summaries-for-regression-models"></a>
</h2>
<p>Summary tables with confidence intervals and p-values for the coefficients of regression models can be obtained using the <code>boot_summary</code> (most models) and <code>censboot_summary</code> (models with censored response variables) functions. Currently, the following models are supported:</p>
<ul>
<li>Linear models fitted using <code>lm</code>,</li>
<li>Generalised linear models fitted using <code>glm</code> or <code>glm.nb</code>,</li>
<li>Nonlinear models fitted using <code>nls</code>,</li>
<li>Robust linear models fitted using <code><a href="https://rdrr.io/pkg/MASS/man/rlm.html" class="external-link">MASS::rlm</a></code>,</li>
<li>Ordered logistic or probit regression models fitted (without weights) using <code>MASS:polr</code>,</li>
<li>Linear mixed models fitted using <code><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lme4::lmer</a></code> or <code>lmerTest::lmer</code>,</li>
<li>Generalised linear mixed models fitted using <code><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">lme4::glmer</a></code>.</li>
<li>Cox PH regression models fitted using <code><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">survival::coxph</a></code> (using <code>censboot_summary</code>).</li>
<li>Accelerated failure time models fitted using <code><a href="https://rdrr.io/pkg/survival/man/survreg.html" class="external-link">survival::survreg</a></code> or <code><a href="https://rdrr.io/pkg/rms/man/psm.html" class="external-link">rms::psm</a></code> (using <code>censboot_summary</code>).</li>
<li>Any regression model such that: <code>residuals(object, type="pearson")</code> returns Pearson residuals; <code>fitted(object)</code> returns fitted values; <code>hatvalues(object)</code> returns the leverages, or perhaps the value 1 which will effectively ignore setting the hatvalues. In addition, the <code>data</code> argument should contain no missing values among the columns actually used in fitting the model.</li>
</ul>
<p>A number of examples are available in Chapters 8 and 9 of <a href="https://www.modernstatisticswithr.com/" class="external-link">Modern Statistics with R</a>.</p>
<p>Here are some simple examples with a linear regression model for the <code>mtcars</code> data:</p>
<p>```{r message=FALSE} # Bootstrap summary of a linear model for mtcars: model &lt;- lm(mpg ~ hp + vs, data = mtcars) boot_summary(model)</p>
</div>
</div>
<div class="section level1">
<h1 id="use-9999-bootstrap-replicates-and-adjust-p-values-for">Use 9999 bootstrap replicates and adjust p-values for<a class="anchor" aria-label="anchor" href="#use-9999-bootstrap-replicates-and-adjust-p-values-for"></a>
</h1>
</div>
<div class="section level1">
<h1 id="multiplicity-using-holms-method">multiplicity using Holm’s method:<a class="anchor" aria-label="anchor" href="#multiplicity-using-holms-method"></a>
</h1>
<p>boot_summary(model, R = 9999, adjust.method = “holm”)</p>
</div>
<div class="section level1">
<h1 id="export-results-to-a-gt-table">Export results to a gt table:<a class="anchor" aria-label="anchor" href="#export-results-to-a-gt-table"></a>
</h1>
<p>boot_summary(model, R = 9999) |&gt; summary_to_gt()</p>
<pre><code>
```{r eval = FALSE}
# Export results to a Word document:
library(flextable)
boot_summary(model, R = 9999) |&gt;
  summary_to_flextable() |&gt;
  save_as_docx(path = "my_table.docx")</code></pre>
<p>And a toy example for a generalised linear mixed model (using a small number of bootstrap repetitions):</p>
<p><code>{r eval = FALSE} library(lme4) model &lt;- glmer(TICKS ~ YEAR + (1|LOCATION),            data = grouseticks, family = poisson) boot_summary(model, R = 99)</code></p>
<div class="section level2">
<h2 id="speeding-up-computations">Speeding up computations<a class="anchor" aria-label="anchor" href="#speeding-up-computations"></a>
</h2>
<p>For complex models, speed can be greatly improved by using parallelisation. For <code>lmer</code> and <code>glmer</code> models, this is set using the <code>parallel</code> (available options are <code>"multicore"</code> and <code>"snow"</code>). The number of CPUs to use is set using <code>ncpus</code>.</p>
<p><code>{r eval = FALSE} model &lt;- glmer(TICKS ~ YEAR + (1|LOCATION),            data = grouseticks, family = poisson) boot_summary(model, R = 999, parallel = "multicore", ncpus = 10)</code></p>
<p>For other models, use <code>ncores</code>:</p>
<p><code>{r eval = FALSE} model &lt;- lm(mpg ~ hp + vs, data = mtcars) boot_summary(model, R = 9999, ncores = 10)</code></p>
</div>
<div class="section level2">
<h2 id="survival-models">Survival models<a class="anchor" aria-label="anchor" href="#survival-models"></a>
</h2>
<p>Survival regression models should be fitted using the argument <code>model = TRUE</code>. A summary table can then be obtained using <code>censboot_summary</code>. By default, the table contains exponentiated coefficients (i.e. hazard ratios, in the case of a Cox PH model).</p>
<p>```{r message = FALSE} library(survival) # Weibull AFT model: model &lt;- survreg(formula = Surv(time, status) ~ age + sex, data = lung, dist = “weibull”, model = TRUE) # Table with exponentiated coefficients: censboot_summary(model)</p>
</div>
</div>
<div class="section level1">
<h1 id="cox-ph-model">Cox PH model:<a class="anchor" aria-label="anchor" href="#cox-ph-model"></a>
</h1>
<p>model &lt;- coxph(formula = Surv(time, status) ~ age + sex, data = lung, model = TRUE) # Table with hazard ratios: censboot_summary(model) # Table with original coefficients: censboot_summary(model, coef = “raw”)</p>
<pre><code>
To speed up computations using parallelisation, use the `parallel` and `ncpus` arguments:

```{r eval = FALSE}
censboot_summary(model, parallel = "multicore", ncpus = 10)</code></pre>
<div class="section level2">
<h2 id="other-hypothesis-tests">Other hypothesis tests<a class="anchor" aria-label="anchor" href="#other-hypothesis-tests"></a>
</h2>
<p>Bootstrap p-values for hypothesis tests based on <code>boot</code> objects can be obtained using the <code>boot.pval</code> function. The following examples are extensions of those given in the documentation for <code><a href="https://rdrr.io/pkg/boot/man/boot.html" class="external-link">boot::boot</a></code>:</p>
<p>```{r message = FALSE} # Hypothesis test for the city data # H0: ratio = 1.4 library(boot) ratio &lt;- function(d, w) sum(d<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>*</mo><mi>w</mi><mo stretchy="false" form="postfix">)</mo><mi>/</mi><mi>s</mi><mi>u</mi><mi>m</mi><mo stretchy="false" form="prefix">(</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">x * w)/sum(d</annotation></semantics></math>u * w) city.boot &lt;- boot(city, ratio, R = 999, stype = “w”, sim = “ordinary”) boot.pval(city.boot, theta_null = 1.4)</p>
</div>
</div>
<div class="section level1">
<h1 id="studentized-test-for-the-two-sample-difference-of-means-problem">Studentized test for the two sample difference of means problem<a class="anchor" aria-label="anchor" href="#studentized-test-for-the-two-sample-difference-of-means-problem"></a>
</h1>
</div>
<div class="section level1">
<h1 id="using-the-final-two-series-of-the-gravity-data">using the final two series of the gravity data.<a class="anchor" aria-label="anchor" href="#using-the-final-two-series-of-the-gravity-data"></a>
</h1>
<p>diff.means &lt;- function(d, f) { n &lt;- nrow(d) gp1 &lt;- 1:table(as.numeric(d$series))[1] m1 &lt;- sum(d[gp1,1] * f[gp1])/sum(f[gp1]) m2 &lt;- sum(d[-gp1,1] * f[-gp1])/sum(f[-gp1]) ss1 &lt;- sum(d[gp1,1]^2 * f[gp1]) - (m1 * m1 * sum(f[gp1])) ss2 &lt;- sum(d[-gp1,1]^2 * f[-gp1]) - (m2 * m2 * sum(f[-gp1])) c(m1 - m2, (ss1 + ss2)/(sum(f) - 2)) } grav1 &lt;- gravity[as.numeric(gravity[,2]) &gt;= 7, ] grav1.boot &lt;- boot(grav1, diff.means, R = 999, stype = “f”, strata = grav1[ ,2]) boot.pval(grav1.boot, type = “stud”, theta_null = 0) ```</p>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=boot.pval" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/mthulin/boot.pval/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/mthulin/boot.pval/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing boot.pval</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Måns Thulin <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Måns Thulin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
