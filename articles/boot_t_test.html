<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Bootstrap tests for location • boot.pval</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bootstrap tests for location">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">boot.pval</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.7.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/boot_summary.html">An introduction to bootstrap p-values for regression models using the boot.pval package</a></li>
    <li><a class="dropdown-item" href="../articles/boot_t_test.html">Bootstrap tests for location</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mthulin/boot.pval/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Bootstrap tests for location</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mthulin/boot.pval/blob/main/vignettes/boot_t_test.Rmd" class="external-link"><code>vignettes/boot_t_test.Rmd</code></a></small>
      <div class="d-none name"><code>boot_t_test.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>Traditional versions of Student’s t-test (<code>t.test</code> in R)
rely on the assumption of normality. For non-normal data, this can lead
to misleading p-values and confidence intervals. In such cases, it is
often recommended to use the Wilcoxon-Mann-Whitney test
(<code>wilcox.test</code> in R) instead. Despite being described as a
test of location, or a test for differences of medians, the
Wilcoxon-Mann-Whitney test is actually a test of equivalence of
distributions, unless strict assumptions are met. In addition,
<code>wilcox.test</code> does not provide a confidence interval for the
difference of the medians.</p>
<p>In many cases, a better option is to use a bootstrap t-test (for
inference about means) or a bootstrap median test (for inference about
medians). These can be used without the normality assumption, and will
provide confidence intervals for the parameters of interest.</p>
<p>This vignette describes how to perform bootstrap t-tests and
bootstrap median tests.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mthulin/boot.pval" class="external-link">boot.pval</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="two-sample-bootstrap-t-tests">Two-sample bootstrap t-tests<a class="anchor" aria-label="anchor" href="#two-sample-bootstrap-t-tests"></a>
</h2>
<p>To illustrate the use of bootstrap t-tests, we’ll use the classic
<code>sleep</code> data, which “show the effect of two soporific drugs
(increase in hours of sleep compared to control) on 10 patients” (see
<code><a href="https://rdrr.io/r/datasets/sleep.html" class="external-link">?sleep</a></code> for details).</p>
<p>We wish to test whether the mean value of the <code>extra</code>
(increase in hours of sleep) variable differs between the two groups
described by the <code>group</code> variable. The syntax for this is
identical to that for <code>t.test</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/boot_t_test.html">boot_t_test</a></span><span class="op">(</span><span class="va">extra</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">sleep</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Welch Two Sample Bootstrap t-test (studentized)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  extra by group</span></span>
<span><span class="co">#&gt; t = -1.8608, R = 9999, p-value = 0.08281</span></span>
<span><span class="co">#&gt; alternative hypothesis: true difference in means between group 1 and group 2 is not equal to 0</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  -3.3910742  0.2349124</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; mean in group 1 mean in group 2 </span></span>
<span><span class="co">#&gt;            0.75            2.33</span></span></code></pre></div>
<p>If you prefer, you can also use the <code>|&gt;</code> pipe as
follows:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sleep</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/boot_t_test.html">boot_t_test</a></span><span class="op">(</span><span class="va">extra</span> <span class="op">~</span> <span class="va">group</span><span class="op">)</span></span></code></pre></div>
<p>By default, the confidence interval and p-value are based on the
studentized bootstrap confidence interval. Other options available are
normal, basic, percentile and BCa intervals; see Chapter 5 of Davison
and Hinkley (1997) for details. You can choose the method used using the
<code>type</code> argument.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sleep</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/boot_t_test.html">boot_t_test</a></span><span class="op">(</span><span class="va">extra</span> <span class="op">~</span> <span class="va">group</span>, type <span class="op">=</span> <span class="st">"perc"</span><span class="op">)</span> <span class="co"># Percentile interval</span></span>
<span><span class="va">sleep</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/boot_t_test.html">boot_t_test</a></span><span class="op">(</span><span class="va">extra</span> <span class="op">~</span> <span class="va">group</span>, type <span class="op">=</span> <span class="st">"bca"</span><span class="op">)</span> <span class="co"># BCa interval</span></span></code></pre></div>
<p>You can control the number of bootstrap replicates used (argument
<code>R</code>; the default is 9999) or the direction of the alternative
hypothesis (argument <code>alternative</code>):</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sleep</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/boot_t_test.html">boot_t_test</a></span><span class="op">(</span><span class="va">extra</span> <span class="op">~</span> <span class="va">group</span>, R <span class="op">=</span> <span class="fl">999</span>, alternative <span class="op">=</span> <span class="st">"less"</span><span class="op">)</span></span></code></pre></div>
<p>In this case, the data is actually paired, so it would make sense to
perform a paired bootstrap t-test instead. We reshape the data to a wide
format, so that the first measurements ends up in the variable
<code>extra.1</code>, and the second measurement ends up in the variable
<code>extra.2</code>. We can then run the test as follows:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Reshape to wide format:</span></span>
<span><span class="va">sleep2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/reshape.html" class="external-link">reshape</a></span><span class="op">(</span><span class="va">sleep</span>, direction <span class="op">=</span> <span class="st">"wide"</span>,</span>
<span>                  idvar <span class="op">=</span> <span class="st">"ID"</span>, timevar <span class="op">=</span> <span class="st">"group"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Traditional interface:</span></span>
<span><span class="fu"><a href="../reference/boot_t_test.html">boot_t_test</a></span><span class="op">(</span><span class="va">sleep2</span><span class="op">$</span><span class="va">extra.1</span>, <span class="va">sleep2</span><span class="op">$</span><span class="va">extra.2</span>, paired <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Using pipes:</span></span>
<span><span class="va">sleep2</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/boot_t_test.html">boot_t_test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Pair.html" class="external-link">Pair</a></span><span class="op">(</span><span class="va">extra.1</span>, <span class="va">extra.2</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="one-sample-bootstrap-t-tests">One-sample bootstrap t-tests<a class="anchor" aria-label="anchor" href="#one-sample-bootstrap-t-tests"></a>
</h2>
<p>For one sample bootstrap t-tests, we only need to provide a single
vector containing the measurements. We can also specify the null value
of the mean (argument <code>mu</code>):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Traditional interface:</span></span>
<span><span class="fu"><a href="../reference/boot_t_test.html">boot_t_test</a></span><span class="op">(</span><span class="va">sleep</span><span class="op">$</span><span class="va">extra</span>, mu <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Using pipes:</span></span>
<span><span class="va">sleep</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/boot_t_test.html">boot_t_test</a></span><span class="op">(</span><span class="va">extra</span> <span class="op">~</span> <span class="fl">1</span>, mu <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="bootstrap-median-tests">Bootstrap median tests<a class="anchor" aria-label="anchor" href="#bootstrap-median-tests"></a>
</h2>
<p>Running a bootstrap median test with the
<code>boot_median_test</code> function is completely analogously to
running a bootstrap t-test. The only difference is under the hood -
medians are used instead of means. Because the studentized and BCa
versions of this test use an inner bootstrap to estimate the variance of
the statistic, these takes longer to run than other tests presented
here.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/boot_median_test.html">boot_median_test</a></span><span class="op">(</span><span class="va">extra</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">sleep</span>, type <span class="op">=</span> <span class="st">"perc"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sleep</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/boot_median_test.html">boot_median_test</a></span><span class="op">(</span><span class="va">extra</span> <span class="op">~</span> <span class="va">group</span>, R <span class="op">=</span> <span class="fl">999</span>, alternative <span class="op">=</span> <span class="st">"less"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/boot_median_test.html">boot_median_test</a></span><span class="op">(</span><span class="va">sleep</span><span class="op">$</span><span class="va">extra</span>, mu <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="reference">Reference<a class="anchor" aria-label="anchor" href="#reference"></a>
</h2>
<ul>
<li>Davison, A.C. and Hinkley, D.V. (1997) <em>Bootstrap Methods and
Their Application</em>. Cambridge University Press.</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Måns Thulin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
